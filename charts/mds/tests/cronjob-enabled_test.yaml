suite: test cronjob enabled
templates:
  - cronjob.yaml
tests:
  - it: all
    values:
      - ./cronjob-values.yaml
    release:
      namespace: mds
    asserts:
      - hasDocuments:
          count: 1
      - isAPIVersion:
          of: batch/v1beta1
      - isKind:
          of: CronJob
      - equal:
          path: metadata.name
          value: hello
      - equal:
          path: metadata.namespace
          value: mds
      - equal:
          path: spec.schedule
          value: "*/1 * * * *"
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].name
          value: hello
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].image
          value: busybox
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].env[0].name
          value: FOO
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].env[0].value
          value: bar
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].args[0]
          value: /bin/sh
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].args[1]
          value: -c
      - equal:
          path: spec.jobTemplate.spec.template.spec.restartPolicy
          value: OnFailure